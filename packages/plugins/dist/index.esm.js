import{Plugin as e,Fragment as t}from"@rte-editor/core";class o extends e{constructor(){super({name:"bold",schema:{marks:{bold:{parseDOM:[{tag:"strong"},{tag:"b"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong",0]}}},commands:{toggleBold:n,setBold:r,unsetBold:s},toolbar:{items:[{id:"bold",icon:"B",label:"Bold",command:"toggleBold",active:e=>{const t=e.schema.marks.bold;return!!t&&t.isInSet(e.storedMarks||[])}}]},keybindings:{"Mod-b":"toggleBold","Mod-B":"toggleBold"}})}}function n(e,t){const o=e.schema.marks.bold;if(!o)return!1;const{from:n,to:r,empty:s}=e.selection;if(console.log("[toggleBold] Selection:",{from:n,to:r,empty:s},"dispatch:",!!t),s){if(t){const n=e.tr,r=e.storedMarks||[];o.isInSet(r)?n.setStoredMarks(r.filter(e=>e.type!==o)):n.setStoredMarks([...r,o.create()]),t(n)}return!0}if(t){const s=e.tr,a=e.doc.rangeHasMark(n,r,o);console.log("[toggleBold] Has mark:",a,"doc children:",e.doc.content.children.length),a?(console.log("[toggleBold] Removing mark"),s.removeMark(n,r,o)):(console.log("[toggleBold] Adding mark"),s.addMark(n,r,o.create())),t(s)}return!0}function r(e,t){const o=e.schema.marks.bold;if(!o)return!1;const{from:n,to:r,empty:s}=e.selection;if(s){if(t){const n=e.tr,r=e.storedMarks||[];o.isInSet(r)||n.setStoredMarks([...r,o.create()]),t(n)}return!0}if(t){const s=e.tr;e.doc.rangeHasMark(n,r,o)||s.addMark(n,r,o.create()),t(s)}return!0}function s(e,t){const o=e.schema.marks.bold;if(!o)return!1;const{from:n,to:r,empty:s}=e.selection;if(s){if(t){const n=e.tr,r=e.storedMarks||[];n.setStoredMarks(r.filter(e=>e.type!==o)),t(n)}return!0}if(t){const s=e.tr;s.removeMark(n,r,o),t(s)}return!0}function a(){return new o}class c extends e{constructor(){super({name:"italic",commands:{toggleItalic:i},toolbar:{items:[{id:"italic",icon:"I",label:"Italic",command:"toggleItalic",active:e=>e.schema.marks.italic.isInSet(e.storedMarks||[])}]},keybindings:{"Mod-i":"toggleItalic","Mod-I":"toggleItalic"}})}}function i(e,t){const o=e.schema.marks.italic;if(!o)return!1;const{from:n,to:r,empty:s}=e.selection;if(s){if(t){const n=e.tr;e.storedMarks?n.setStoredMarks(e.storedMarks.filter(e=>e.type!==o)):n.setStoredMarks([o.create()]),t(n)}return!0}if(t){const s=e.tr;e.doc.rangeHasMark(n,r,o)?s.removeMark(n,r,o):s.addMark(n,r,o.create()),t(s)}return!0}function l(){return new c}class d extends e{constructor(){super({name:"heading",commands:{setHeading:e=>m(e),toggleHeading:e=>function(e){return(t,o)=>u(t,e)?m(0)(t,o):m(e)(t,o)}(e)},toolbar:{items:[{id:"heading1",icon:"H1",label:"Heading 1",command:"setHeading",commandArgs:[1],active:e=>u(e,1)},{id:"heading2",icon:"H2",label:"Heading 2",command:"setHeading",commandArgs:[2],active:e=>u(e,2)},{id:"heading3",icon:"H3",label:"Heading 3",command:"setHeading",commandArgs:[3],active:e=>u(e,3)}]},keybindings:{"Mod-Alt-1":"setHeading(1)","Mod-Alt-2":"setHeading(2)","Mod-Alt-3":"setHeading(3)","Mod-Alt-4":"setHeading(4)","Mod-Alt-5":"setHeading(5)","Mod-Alt-6":"setHeading(6)","Mod-Alt-0":"setHeading(0)"}})}}function u(e,t){const{$from:o,$to:n}=e.selection;let r=!1;return e.doc.nodesBetween(o.pos,n.pos,e=>"heading"!==e.type.name||e.attrs.level!==t||(r=!0,!1)),r}function m(e){return(t,o)=>{const n=t.schema.nodes.heading,r=t.schema.nodes.paragraph;if(!n||!r)return!1;const{$from:s,$to:a}=t.selection;let c=!1;if(t.doc.nodesBetween(s.pos,a.pos,(e,t)=>"paragraph"!==e.type.name&&"heading"!==e.type.name||(c=!0,!1)),!c)return!1;if(o){const c=t.tr;0===e?c.setBlockType(s.pos,a.pos,r):c.setBlockType(s.pos,a.pos,n,{level:e}),o(c)}return!0}}function g(){return new d}class h extends e{constructor(){super({name:"paragraph",schema:{nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]}}},commands:{setParagraph:(e,t)=>{if(t){t(e.tr.setBlockType(e.selection.from,e.selection.to,e.schema.nodes.paragraph))}return!0}},toolbar:{items:[{id:"paragraph",icon:"P",label:"Paragraph",command:"setParagraph"}]}})}}function f(){return new h}class p extends e{constructor(e={}){super({name:"history",commands:{undo:b,redo:k,clearHistory:M},toolbar:{items:[{id:"undo",icon:"â†¶",label:"Undo",command:"undo",enabled:e=>({done:[],undone:[],depth:100,newGroupDelay:500}.done.length>0)},{id:"redo",icon:"â†·",label:"Redo",command:"redo",enabled:e=>({done:[],undone:[],depth:100,newGroupDelay:500}.undone.length>0)}]},keybindings:{"Mod-z":"undo","Mod-y":"redo","Mod-Shift-z":"redo"},onTransaction:(e,t)=>{this.handleTransaction(e,t.state)}}),this.historyState={done:[],undone:[],depth:e.depth||100,newGroupDelay:e.newGroupDelay||500}}handleTransaction(e,t){const o=e.getMeta("history");"ignore"!==o&&("undo"!==o?"redo"!==o?(this.historyState.done.push(e),this.historyState.undone=[],this.historyState.done.length>this.historyState.depth&&this.historyState.done.shift()):this.historyState.done.push(e):this.historyState.undone.push(e))}}function b(e,t){const o={done:[],undone:[],depth:100,newGroupDelay:500};if(0===o.done.length)return!1;if(t){const n=o.done[o.done.length-1],r=e.tr.setMeta("history","undo");if(n.steps)for(let t=n.steps.length-1;t>=0;t--){const o=n.steps[t];if(o.invert){const t=o.invert(e);t&&r.step(t)}}t(r)}return!0}function k(e,t){const o={done:[],undone:[],depth:100,newGroupDelay:500};if(0===o.undone.length)return!1;if(t){const n=o.undone[o.undone.length-1],r=e.tr.setMeta("history","redo");if(n.steps)for(const e of n.steps)r.step(e);t(r)}return!0}function M(e,t){if(t){t(e.tr.setMeta("history","clear"))}return!0}function y(e){return new p(e)}class w extends e{constructor(){super({name:"list",schema:{nodes:{bullet_list:{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",0]},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1})}],toDOM:e=>1===e.attrs.order?["ol",0]:["ol",{start:e.attrs.order},0]},list_item:{content:"paragraph block*",parseDOM:[{tag:"li"}],toDOM:()=>["li",0],defining:!0}}},commands:{toggleBulletList:A,toggleOrderedList:O,liftListItem:S,sinkListItem:H},toolbar:{items:[{id:"bullet-list",icon:"â€¢",label:"Bullet List",command:"toggleBulletList",active:e=>B(e)},{id:"ordered-list",icon:"1.",label:"Numbered List",command:"toggleOrderedList",active:e=>D(e)}]},keybindings:{"Mod-Shift-8":"toggleBulletList","Mod-Shift-7":"toggleOrderedList",Tab:"sinkListItem","Shift-Tab":"liftListItem"}})}}function B(e){const{from:t,to:o}=e.selection;let n=!1;return e.doc.nodesBetween(t,o,(e,t,o)=>{if(o&&"bullet_list"===o.type.name)return n=!0,!1}),n}function D(e){const{from:t,to:o}=e.selection;let n=!1;return e.doc.nodesBetween(t,o,(e,t,o)=>{if(o&&"ordered_list"===o.type.name)return n=!0,!1}),n}function A(e,o){const n=e.schema.nodes.bullet_list,r=e.schema.nodes.list_item,s=e.schema.nodes.paragraph;if(!n||!r||!s)return!1;if(B(e)){if(o){const n=e.doc,r=[];n.content.children.forEach(e=>{"bullet_list"===e.type.name?e.content.children.forEach(e=>{e.content.children.length>0&&r.push(e.content.children[0])}):r.push(e)});const s=n.type.create(n.attrs,t.from(r));o(e.tr.setDoc(s))}return!0}if(o){const a=e.doc,{from:c,to:i}=e.selection,l=[],d=[];a.content.children.forEach(e=>{if("paragraph"===e.type.name){const o=s.create({},e.content);d.push(r.create({},t.from([o])))}else d.length>0&&(l.push(n.create({},t.from(d))),d.length=0),l.push(e)}),d.length>0&&l.push(n.create({},t.from(d)));const u=a.type.create(a.attrs,t.from(l));o(e.tr.setDoc(u))}return!0}function O(e,o){const n=e.schema.nodes.ordered_list,r=e.schema.nodes.list_item,s=e.schema.nodes.paragraph;if(!n||!r||!s)return!1;if(D(e)){if(o){const n=e.doc,r=[];n.content.children.forEach(e=>{"ordered_list"===e.type.name?e.content.children.forEach(e=>{e.content.children.length>0&&r.push(e.content.children[0])}):r.push(e)});const s=n.type.create(n.attrs,t.from(r));o(e.tr.setDoc(s))}return!0}if(o){const a=e.doc,c=[],i=[];a.content.children.forEach(e=>{if("paragraph"===e.type.name){const o=s.create({},e.content);i.push(r.create({},t.from([o])))}else i.length>0&&(c.push(n.create({},t.from(i))),i.length=0),c.push(e)}),i.length>0&&c.push(n.create({},t.from(i)));const l=a.type.create(a.attrs,t.from(c));o(e.tr.setDoc(l))}return!0}function S(e,t){if(t){t(e.tr.lift(e.selection.from,e.selection.to))}return!0}function H(e,t){if(t){t(e.tr.wrap(e.selection.from,e.selection.to,e.schema.nodes.list_item))}return!0}function v(){return new w}class _ extends e{constructor(){super({name:"blockquote",schema:{nodes:{blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]}}},commands:{toggleBlockquote:(e,t)=>{const o=e.schema.nodes.blockquote,n=e.schema.nodes.paragraph;if(t){const{from:r,to:s}=e.selection,a=e.tr;let c=!1;e.doc.nodesBetween(r,s,(e,t,n)=>{if(n&&n.type===o)return c=!0,!1}),c?a.setBlockType(r,s,n):a.wrapIn(o),t(a)}return!0}},toolbar:{items:[{id:"blockquote",icon:"â",label:"Quote",command:"toggleBlockquote"}]},keybindings:{"Mod-Shift-.":"toggleBlockquote"}})}}function I(){return new _}class L extends e{constructor(){super({name:"table",schema:{nodes:{table:{content:"table_row+",group:"block",isolating:!0,parseDOM:[{tag:"table"}],toDOM:()=>["table",{class:"rte-table"},["tbody",0]]},table_row:{content:"table_cell+",parseDOM:[{tag:"tr"}],toDOM:()=>["tr",0]},table_cell:{content:"block+",attrs:{colspan:{default:1},rowspan:{default:1}},parseDOM:[{tag:"td"},{tag:"th"}],toDOM:e=>{const t={};return 1!==e.attrs.colspan&&(t.colspan=e.attrs.colspan),1!==e.attrs.rowspan&&(t.rowspan=e.attrs.rowspan),["td",t,0]}}}},commands:{insertTable:T,addRowBefore:x,addRowAfter:C,addColumnBefore:R,addColumnAfter:q,deleteRow:E,deleteColumn:G,toggleHeaderRow:z},toolbar:{items:[{id:"insert-table",icon:"âŠž",label:"Insert Table",command:"insertTable"}]},keybindings:{"Mod-Alt-T":"insertTable"}})}}function T(e=3,o=3){return(n,r)=>{const s=n.schema.nodes.table,a=n.schema.nodes.table_row,c=n.schema.nodes.table_cell,i=n.schema.nodes.paragraph;if(!(s&&a&&c&&i))return!1;if(r){const l=n.tr,d=[];for(let n=0;n<e;n++){const e=[];for(let n=0;n<o;n++)e.push(c.create({},t.from([i.create()])));d.push(a.create({},t.from(e)))}const u=s.create({},t.from(d));l.replaceSelectionWith(u),r(l)}return!0}}function x(e,t){return!1}function C(e,t){return!1}function R(e,t){return!1}function q(e,t){return!1}function E(e,t){return!1}function G(e,t){return!1}function z(e,t){return!1}function $(){return new L}class P extends e{constructor(e={}){super({name:"image",schema:{nodes:{image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt"),width:e.getAttribute("width"),height:e.getAttribute("height")})}],toDOM:e=>["img",e.attrs]}}},commands:{insertImage:(e,t)=>(o,n)=>{const r=o.schema.nodes.image;if(n){const s=e||prompt("Enter image URL:");if(s){const e={src:s};t&&(e.alt=t);const a=r.create(e);n(o.tr.replaceSelectionWith(a))}}return!0},uploadImage:t=>(o,n)=>{if(e.maxSize&&t.size>e.maxSize)return alert("File too large"),!1;const r=new FileReader;return r.onload=e=>{const r=e.target?.result;if(r&&n){const e=o.schema.nodes.image.create({src:r,alt:t.name}),s=o.tr.replaceSelectionWith(e);n(s)}},r.readAsDataURL(t),!0}},toolbar:{items:[{id:"image",icon:"ðŸ–¼ï¸",label:"Image",command:"insertImage"}]}})}}function U(e){return new P(e)}class W extends e{constructor(){super({name:"link",schema:{marks:{link:{attrs:{href:{},title:{default:null},target:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title"),target:e.getAttribute("target")})}],toDOM:e=>["a",e.attrs,0]}}},commands:{toggleLink:e=>(t,o)=>{const n=t.schema.marks.link,{from:r,to:s}=t.selection;if(o){const a=t.tr;if(t.doc.rangeHasMark(r,s,n))a.removeMark(r,s,n);else{const t=e||prompt("Enter URL:");t&&a.addMark(r,s,n.create({href:t}))}o(a)}return!0},removeLink:(e,t)=>{const o=e.schema.marks.link,{from:n,to:r}=e.selection;if(t){t(e.tr.removeMark(n,r,o))}return!0}},toolbar:{items:[{id:"link",icon:"ðŸ”—",label:"Link",command:"toggleLink"},{id:"unlink",icon:"ðŸ”—âŒ",label:"Remove Link",command:"removeLink"}]},keybindings:{"Mod-k":"toggleLink"}})}}function F(){return new W}class N extends e{constructor(){super({name:"codeblock",schema:{nodes:{code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,attrs:{language:{default:null}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>({language:e.getAttribute("data-language")})}],toDOM:e=>["pre",e.attrs.language?{"data-language":e.attrs.language}:{},["code",0]]}},marks:{code:{parseDOM:[{tag:"code"}],toDOM:()=>["code",0]}}},commands:{toggleCodeBlock:(e,t)=>{const o=e.schema.nodes.code_block,n=e.schema.nodes.paragraph;if(t){const{from:r,to:s}=e.selection,a=e.tr;let c=!1;e.doc.nodesBetween(r,s,e=>{if(e.type===o)return c=!0,!1}),c?a.setBlockType(r,s,n):a.setBlockType(r,s,o),t(a)}return!0},toggleCode:(e,t)=>{const o=e.schema.marks.code,{from:n,to:r}=e.selection;if(t){const s=e.tr;e.doc.rangeHasMark(n,r,o)?s.removeMark(n,r,o):s.addMark(n,r,o.create()),t(s)}return!0}},toolbar:{items:[{id:"code_block",icon:"{ }",label:"Code Block",command:"toggleCodeBlock"},{id:"code",icon:"</>",label:"Inline Code",command:"toggleCode"}]},keybindings:{"Mod-Alt-c":"toggleCodeBlock","Mod-`":"toggleCode"}})}}function Q(){return new N}export{_ as BlockquotePlugin,o as BoldPlugin,N as CodeBlockPlugin,d as HeadingPlugin,p as HistoryPlugin,P as ImagePlugin,c as ItalicPlugin,W as LinkPlugin,w as ListPlugin,h as ParagraphPlugin,L as TablePlugin,I as createBlockquotePlugin,a as createBoldPlugin,Q as createCodeBlockPlugin,g as createHeadingPlugin,y as createHistoryPlugin,U as createImagePlugin,l as createItalicPlugin,F as createLinkPlugin,v as createListPlugin,f as createParagraphPlugin,$ as createTablePlugin};
//# sourceMappingURL=index.esm.js.map
