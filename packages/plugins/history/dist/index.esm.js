import{Plugin as e}from"@rte-editor/core";class t extends e{constructor(e={}){super({name:"history",commands:{undo:n,redo:o,clearHistory:r},toolbar:{items:[{id:"undo",icon:"↶",label:"Undo",command:"undo",enabled:e=>({done:[],undone:[],depth:100,newGroupDelay:500}.done.length>0)},{id:"redo",icon:"↷",label:"Redo",command:"redo",enabled:e=>({done:[],undone:[],depth:100,newGroupDelay:500}.undone.length>0)}]},keybindings:{"Mod-z":"undo","Mod-y":"redo","Mod-Shift-z":"redo"},onTransaction:(e,t)=>{this.handleTransaction(e,t.state)}}),this.historyState={done:[],undone:[],depth:e.depth||100,newGroupDelay:e.newGroupDelay||500}}handleTransaction(e,t){const n=e.getMeta("history");"ignore"!==n&&("undo"!==n?"redo"!==n?(this.historyState.done.push(e),this.historyState.undone=[],this.historyState.done.length>this.historyState.depth&&this.historyState.done.shift()):this.historyState.done.push(e):this.historyState.undone.push(e))}}function n(e,t){const n={done:[],undone:[],depth:100,newGroupDelay:500};if(0===n.done.length)return!1;if(t){const o=n.done[n.done.length-1],r=e.tr.setMeta("history","undo");if(o.steps)for(let t=o.steps.length-1;t>=0;t--){const n=o.steps[t];if(n.invert){const t=n.invert(e);t&&r.step(t)}}t(r)}return!0}function o(e,t){const n={done:[],undone:[],depth:100,newGroupDelay:500};if(0===n.undone.length)return!1;if(t){const o=n.undone[n.undone.length-1],r=e.tr.setMeta("history","redo");if(o.steps)for(const e of o.steps)r.step(e);t(r)}return!0}function r(e,t){if(t){t(e.tr.setMeta("history","clear"))}return!0}function s(e){return new t(e)}export{t as HistoryPlugin,s as createHistoryPlugin};
//# sourceMappingURL=index.esm.js.map
