{"version":3,"file":"index.cjs.js","sources":["../src/context/EditorContext.tsx","../src/components/Toolbar.tsx","../src/utils/SelectionManager.ts","../src/components/EditorContent.tsx","../src/components/RichTextEditor.tsx","../src/hooks/useEditor.ts"],"sourcesContent":[null,null,null,null,null,null],"names":["EditorContext","createContext","useEditorContext","context","useContext","Error","EditorProvider","state","dispatch","plugins","editor","view","children","contextValue","_jsx","Provider","value","Toolbar","className","items","toolbarItems","flatMap","plugin","config","getToolbarConfig","length","_jsxs","onMouseDown","e","preventDefault","executeCommand","title","handleCommand","commandName","commandArgs","domSelection","window","getSelection","editorDom","document","querySelector","rangeCount","range","getRangeAt","from","getDocPosition","startContainer","startOffset","to","endContainer","endOffset","$from","ResolvedPos","resolve","doc","$to","update","selection","TextSelection","requestAnimationFrame","newRange","createRange","walker","createTreeWalker","NodeFilter","SHOW_TEXT","node","currentPos","startNode","endNode","nextNode","nodeLength","textContent","setStart","Math","max","setEnd","removeAllRanges","addRange","focus","root","offset","pos","currentNode","map","item","ToolbarButton","onCommand","id","isActive","active","isEnabled","enabled","type","command","disabled","label","icon","SelectionManager","constructor","element","this","savedRange","setElement","saveSelection","save","restoreSelection","restore","contains","anchorNode","cloneRange","preserveSelection","fn","result","setTimeout","getCursorOffset","preCaretRange","selectNodeContents","toString","setCursorOffset","currentOffset","textLength","collapse","EditorContent","placeholder","readOnly","autoFocus","spellCheck","contentRef","useRef","selectionManager","isInternalUpdate","lastContent","useEffect","current","setView","dom","blur","updateState","newState","handleInput","useCallback","handleCompositionStart","handleCompositionEnd","handlePaste","event","clipboardData","htmlData","getData","textData","content","insertContent","handleDrop","data","dataTransfer","handleDragOver","handleKeyDown","key","ctrlOrCmd","ctrlKey","metaKey","shift","shiftKey","altKey","toLowerCase","syncSelectionToEditor","commonAncestorContainer","tr","setSelection","create","handleFocus","handleBlur","html","getHTML","innerHTML","ref","contentEditable","suppressContentEditableWarning","onInput","onCompositionStart","onCompositionEnd","onPaste","onDrop","onDragOver","onKeyDown","onFocus","onBlur","role","style","minHeight","padding","outline","lineHeight","wordWrap","overflowWrap","RichTextEditor","onChange","theme","showToolbar","props","setEditor","useState","editorState","setEditorState","editorInstance","Editor","onUpdate","transaction","destroy","containerRef","containerClasses","filter","Boolean","join","useMemo","commands","getCommands","undefined","schema"],"mappings":"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"}